<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>관리자 통계</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="p-5">
<h2>통계 정보</h2>

<h4>항공편별 예매 수</h4>
<table class="table table-bordered">
  <tr><th>항공편</th><th>예매 수</th></tr>
  <tr th:each="row : ${flightReservationStats}">
    <td th:text="${row[0]}"></td>
    <td th:text="${row[1]}"></td>
  </tr>
</table>

<h4>항공편별 취소 수</h4>
<table class="table table-bordered">
  <tr><th>항공편</th><th>취소 수</th></tr>
  <tr th:each="row : ${flightCancelStats}">
    <td th:text="${row[0]}"></td>
    <td th:text="${row[1]}"></td>
  </tr>
</table>

<h4>좌석 등급별 총 예매 금액</h4>
<table class="table table-bordered">
  <tr><th>좌석 등급</th><th>총 예매 금액</th></tr>
  <tr th:each="row : ${seatClassStats}">
    <td th:text="${row[0]}"></td>
    <td th:text="${row[1]} + '원'"></td>
  </tr>
</table>

<h4>월별 매출</h4>
<table class="table table-bordered">
  <tr><th>월</th><th>매출</th></tr>
  <tr th:each="row : ${monthlyRevenueStats}">
    <td th:text="${row[0]}"></td>
    <td th:text="${row[1]} + '원'"></td>
  </tr>
</table>

<h4>총 예매 금액: <span th:text="${totalPayment} + '원'"></span></h4>
<h4>총 환불 금액: <span th:text="${totalRefund} + '원'"></span></h4>

<h4>고객별 예매/환불 수</h4>
<table class="table table-bordered">
  <tr><th>고객명</th><th>예매 수</th></tr>
  <tr th:each="row : ${customerStats}">
    <td th:text="${row[0]}"></td>  <!-- 고객명 -->
    <td th:text="${row[1]}"></td>  <!-- 예매 수 -->
  </tr>
</table>
<h4>고객별 예약 누적 수 (윈도우 함수)</h4>
<table class="table table-bordered">
  <tr>
    <th>회원번호</th>
    <th>이름</th>
    <th>예약일시</th>
    <th>누적 예약 수</th>
  </tr>
  <tr th:each="row : ${cumulativeStats}">
    <td th:text="${row[0]}"></td>
    <td th:text="${row[1]}"></td>
    <td th:text="${#dates.format(row[2], 'yyyy-MM-dd HH:mm')}"></td>
    <td th:text="${row[3]}"></td>
  </tr>
</table>

</body>
</html>
